name: üîí Security Vulnerability
description: Report a security vulnerability in dev-platform (use sparingly - prefer private reporting)
title: "[SECURITY]: "
labels: ["security", "vulnerability", "critical"]
assignees: []

body:
  - type: markdown
    attributes:
      value: |
        ## ‚ö†Ô∏è IMPORTANT SECURITY NOTICE
        
        **For serious security vulnerabilities, please use our [private vulnerability reporting](https://github.com/swm-sink/dev-platform/security/advisories/new) instead of this public form.**
        
        **This public form should only be used for:**
        - Minor security improvements
        - Questions about security practices
        - Documentation of security considerations
        
        **Use private reporting for:**
        - Command injection vulnerabilities
        - Path traversal issues
        - Information disclosure
        - Any issue that could be exploited
        
        üìß **Private Contact:** security@dev-platform.org

  - type: checkboxes
    id: reporting-type
    attributes:
      label: Type of Security Report
      description: Select the appropriate type (choose carefully)
      options:
        - label: Minor security improvement suggestion
        - label: Security best practice question
        - label: Documentation of security considerations
        - label: "‚ö†Ô∏è This should be private - I understand the risk of public disclosure"
    validations:
      required: true

  - type: dropdown
    id: vulnerability-type
    attributes:
      label: Vulnerability Category
      description: What type of security issue is this?
      options:
        - Command Injection (CWE-78)
        - Path Traversal (CWE-22)
        - Code Injection (CWE-94)
        - Information Disclosure (CWE-200)
        - Improper Input Validation (CWE-20)
        - Improper Access Control (CWE-284)
        - Security Configuration Issue
        - Documentation/Practice Improvement
        - Other (specify in description)
    validations:
      required: true

  - type: input
    id: affected-component
    attributes:
      label: Affected Component
      description: Which pattern, script, or component is affected?
      placeholder: "e.g., patterns/security/security-basics.sh, scripts/install.sh"
    validations:
      required: true

  - type: dropdown
    id: severity-assessment
    attributes:
      label: Severity Assessment
      description: How severe do you assess this vulnerability?
      options:
        - Critical (Remote code execution, privilege escalation)
        - High (Significant security impact)
        - Medium (Moderate security risk)
        - Low (Minor security concern)
        - Info (Security best practice suggestion)
    validations:
      required: true

  - type: textarea
    id: vulnerability-description
    attributes:
      label: Vulnerability Description
      description: |
        Describe the vulnerability clearly but avoid providing exploit details in this public form.
        **Focus on the security impact rather than exploitation steps.**
      placeholder: |
        Brief description of the security issue:
        - What component is affected
        - What type of vulnerability it is
        - General security impact
        
        (Save detailed exploitation steps for private reporting)
    validations:
      required: true

  - type: textarea
    id: security-impact
    attributes:
      label: Security Impact
      description: What could an attacker achieve with this vulnerability?
      placeholder: |
        Potential security impacts:
        - Data access or modification
        - System command execution
        - Information disclosure
        - Denial of service
        - Privilege escalation
        
        Affected systems:
        - Developer workstations
        - CI/CD pipelines
        - Production environments
    validations:
      required: true

  - type: dropdown
    id: exploitability
    attributes:
      label: Exploitability
      description: How easy is this vulnerability to exploit?
      options:
        - Very Easy (No authentication required, simple exploit)
        - Easy (Basic authentication or simple conditions)
        - Moderate (Specific conditions or access required)
        - Difficult (Complex conditions or advanced knowledge)
        - Very Difficult (Highly specific conditions)
    validations:
      required: true

  - type: textarea
    id: affected-scenarios
    attributes:
      label: Affected Usage Scenarios
      description: In what scenarios could this vulnerability be exploited?
      placeholder: |
        This vulnerability could be exploited when:
        - Users run patterns with untrusted input
        - Patterns are used in automated environments
        - Multiple patterns are composed together
        - Specific configuration conditions are met
    validations:
      required: true

  - type: textarea
    id: reproduction-info
    attributes:
      label: General Reproduction Information
      description: |
        Provide general information about reproducing this issue.
        **Do NOT include specific exploit code in this public form.**
      placeholder: |
        General reproduction approach:
        1. Set up environment with...
        2. Configure pattern with...
        3. Provide input that...
        4. Observe security impact...
        
        (Detailed steps provided privately via security@dev-platform.org)
    validations:
      required: false

  - type: dropdown
    id: discovery-method
    attributes:
      label: Discovery Method
      description: How was this vulnerability discovered?
      options:
        - Code review
        - Static analysis tool
        - Dynamic testing
        - Security research
        - User report
        - Bug bounty
        - Other
    validations:
      required: true

  - type: textarea
    id: mitigation-suggestions
    attributes:
      label: Mitigation Suggestions
      description: Do you have suggestions for fixing this vulnerability?
      placeholder: |
        Suggested mitigations:
        - Input validation improvements
        - Output sanitization
        - Access control enhancements
        - Configuration changes
        - Code restructuring
        
        (Detailed patches provided privately if available)
    validations:
      required: false

  - type: checkboxes
    id: security-standards
    attributes:
      label: Security Standards Impact
      description: Which security standards or practices does this affect?
      options:
        - label: OWASP Secure Coding Practices
        - label: CWE (Common Weakness Enumeration)
        - label: NIST Cybersecurity Framework
        - label: Secure development lifecycle
        - label: Input validation best practices
        - label: Output encoding standards
        - label: Access control principles

  - type: textarea
    id: references
    attributes:
      label: Security References
      description: Any relevant security references or standards
      placeholder: |
        Relevant references:
        - CWE-XX: Description
        - OWASP guideline: URL
        - Security paper/blog: URL
        - Similar vulnerability: URL
    validations:
      required: false

  - type: checkboxes
    id: disclosure-timeline
    attributes:
      label: Responsible Disclosure
      description: Disclosure timeline preferences
      options:
        - label: I understand this will be publicly visible immediately
        - label: I have also sent details privately to security@dev-platform.org
        - label: I am willing to coordinate disclosure timeline
        - label: I prefer immediate public disclosure
        - label: I request coordinated disclosure (30-90 days)

  - type: checkboxes
    id: credit-preferences
    attributes:
      label: Credit Preferences
      description: How would you like to be credited for this report?
      options:
        - label: Public credit in security advisory
        - label: Public credit in release notes
        - label: Credit in AUTHORS.md
        - label: Anonymous reporting (no public credit)
        - label: Credit under different name (specify in additional info)

  - type: textarea
    id: additional-info
    attributes:
      label: Additional Information
      description: |
        Any additional context:
        - Credit name preferences
        - Related vulnerabilities
        - Coordination preferences
        - Contact information for follow-up
      placeholder: "Additional security context..."

  - type: checkboxes
    id: testing-offer
    attributes:
      label: Testing Assistance
      options:
        - label: I can help test the fix
        - label: I can review security patches
        - label: I can provide additional test cases
        - label: I'm available for security coordination

  - type: checkboxes
    id: security-checklist
    attributes:
      label: Security Reporting Checklist
      options:
        - label: I considered using private vulnerability reporting instead
          required: true
        - label: I understand this report will be publicly visible
          required: true
        - label: I did not include detailed exploit code in this public report
          required: true
        - label: I'm willing to participate in responsible disclosure
          required: true
        - label: I have read the project's security policy
          required: true

  - type: markdown
    attributes:
      value: |
        ---
        
        ## üîê Security Response Commitment
        
        - **Acknowledgment:** Within 24 hours
        - **Initial Assessment:** Within 72 hours
        - **Fix Timeline:** Based on severity (7-30 days)
        - **Public Disclosure:** After fix is available
        
        ## üìû Security Team Contact
        
        - **Email:** security@dev-platform.org
        - **PGP Key:** Available at github.com/swm-sink/dev-platform/security
        - **Private Reporting:** Use GitHub Security Advisories
        
        Thank you for helping keep dev-platform secure! üõ°Ô∏è